<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>HUBERCIK — Quiz ADR/RID (50 pytań)</title>
<style>
  :root{
    --bg1:#0b0f19;
    --bg2:#141926;
    --bg3:#0e121e;
    --card:#111827;
    --muted:#94a3b8;
    --text:#e5e7eb;
    --accent:#ef4444; /* fire red accent */
    --accent2:#9ca3af; /* gray */
    --ok:#22c55e;
    --bad:#ef4444;
    --border:#1f2937;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "DejaVu Sans", Arial, "Apple Color Emoji","Segoe UI Emoji";
    background:
      radial-gradient(1200px 800px at 10% -10%, rgba(239,68,68,.18), transparent 55%),
      radial-gradient(900px 600px at 110% 10%, rgba(156,163,175,.18), transparent 60%),
      linear-gradient(180deg, var(--bg1), var(--bg2));
    color:var(--text);
  }
  .container{max-width:980px;margin:24px auto;padding:0 16px}
  .card{
    background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
    border: 1px solid var(--border);
    border-radius: 18px;
    box-shadow: 0 20px 40px rgba(0,0,0,.35);
    overflow:hidden;
  }
  header{
    padding:18px 18px 16px 18px;
    background: linear-gradient(90deg, rgba(239,68,68,.18), rgba(156,163,175,.12));
    border-bottom:1px solid var(--border);
    display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;
  }
  .brand{display:flex;align-items:center;gap:12px}
  .logo{
    width:38px;height:38px;border-radius:10px;
    background: radial-gradient(18px 18px at 60% 30%, rgba(239,68,68,.85), rgba(239,68,68,.45));
    border:1px solid rgba(239,68,68,.5);
    box-shadow: inset 0 0 12px rgba(239,68,68,.35), 0 2px 10px rgba(0,0,0,.25);
    position:relative;
  }
  .logo:after{
    content:"";position:absolute;inset:8px 10px 8px 10px;border-radius:8px;
    border-left:2px solid rgba(255,255,255,.25);
    border-right:2px solid rgba(255,255,255,.08);
  }
  .title{margin:0;font-weight:800;letter-spacing:.5px}
  .title small{display:block;color:var(--muted);font-weight:600;letter-spacing:.2px}
  .hub{font-size:20px}
  .hub span{color:var(--accent);}
  .meta{color:var(--muted);font-size:14px}
  .content{padding:18px}
  .topbar{display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;margin-bottom:10px}
  .pill{border:1px solid var(--border);padding:6px 10px;border-radius:999px;color:var(--muted);font-weight:600}
  .progress{width:100%;height:10px;background:#0b1224;border-radius:999px;border:1px solid var(--border);overflow:hidden;margin:8px 0 14px}
  .progress>div{height:100%;width:0;background:linear-gradient(90deg, var(--accent), #f97316);transition:width .25s ease}
  .qwrap{margin-top:6px}
  .qhead{display:flex;justify-content:space-between;align-items:flex-start;gap:12px}
  .qindex{color:var(--muted);font-size:14px}
  .qtitle{font-weight:700;font-size:18px;line-height:1.35}
  .answers{display:grid;gap:10px;margin-top:14px}
  .btn{
    width:100%;text-align:left;padding:16px;border-radius:14px;border:1px solid var(--border);
    background:var(--bg3);color:var(--text);cursor:pointer;transition:.12s;
    display:flex;gap:10px;align-items:center;min-height:56px;
  }
  .btn:hover{border-color:#334155;transform:translateY(-1px)}
  .btn.correct{border-color:rgba(34,197,94,.7);background:linear-gradient(180deg, rgba(34,197,94,.15), rgba(34,197,94,.05))}
  .btn.wrong{border-color:rgba(239,68,68,.7);background:linear-gradient(180deg, rgba(239,68,68,.15), rgba(239,68,68,.05))}
  .letter{
    flex:0 0 32px;height:32px;border-radius:10px;border:1px solid var(--border);
    display:grid;place-items:center;color:#cbd5e1;font-weight:800
  }
  .ans-text{flex:1}
  .explain{
    margin-top:12px;padding:12px 14px;border-radius:12px;border:1px dashed #334155;background:rgba(148,163,184,.07);
    color:#cbd5e1;display:none
  }
  .explain strong{color:#e2e8f0}
  .controls{display:flex;gap:10px;flex-wrap:wrap;margin-top:16px}
  .control{
    padding:12px 14px;border-radius:12px;border:1px solid var(--border);background:var(--bg3);color:var(--text);
    cursor:pointer;transition:.12s;font-weight:700;
  }
  .control.primary{background:linear-gradient(90deg, var(--accent), #f97316);color:#0b1224;border:none}
  .control:hover{filter:brightness(1.06);transform:translateY(-1px)}
  .scorebar{
    border:1px solid var(--border);border-radius:12px;padding:10px 12px;display:flex;justify-content:space-between;align-items:center;
    background:var(--bg3);margin-top:10px
  }
  .badge{padding:6px 10px;border-radius:10px;font-weight:800}
  .ok{background:rgba(34,197,94,.12);border:1px solid rgba(34,197,94,.35);color:#86efac}
  .ko{background:rgba(239,68,68,.12);border:1px solid rgba(239,68,68,.35);color:#fecaca}
  .hidden{display:none}

  /* Start screen */
  .start{
    padding:28px 22px;text-align:center;
  }
  .start h2{margin:6px 0 8px 0;font-size:22px}
  .start p{margin:0;color:var(--muted)}
  .start .big{font-size:28px;font-weight:900;letter-spacing:.6px}
  .start .accent{color:var(--accent)}

  /* Mobile-friendly tweaks */
  @media (max-width:720px){
    .title{font-size:18px}
    .hub{font-size:18px}
    .btn{min-height:60px;padding:16px 14px;border-radius:16px}
    .letter{width:34px;height:34px;border-radius:12px}
    .qtitle{font-size:17px}
    .control{flex:1 1 auto;text-align:center}
  }
  @media (max-width:420px){
    header{padding:14px}
    .answers{gap:12px}
    .btn{min-height:64px}
  }
</style>
</head>
<body>
  <div class="container">
    <div class="card">
      <header>
        <div class="brand">
          <div class="logo" aria-hidden="true"></div>
          <div>
            <h1 class="title">
              <span class="hub">HUBER<span>CIK</span></span> — Quiz ADR/RID
              <small>50 pytań • losowe • tryb offline</small>
            </h1>
          </div>
        </div>
        <div class="meta">Ciemny motyw • Strażacki</div>
      </header>

      <div class="content">
        <!-- Start Screen -->
        <div id="startScreen" class="start">
          <div class="big">HUBERCIK</div>
          <h2>Quiz ADR/RID</h2>
          <p>50 pytań • jedna poprawna odpowiedź • wyjaśnienia po kliknięciu</p>
          <div class="controls" style="justify-content:center;margin-top:18px">
            <button class="control primary" id="startBtn">Start</button>
          </div>
        </div>

        <!-- Quiz UI -->
        <div id="quizUI" class="hidden">
          <div class="topbar">
            <div class="pill" id="progressLabel">Pytanie 1/50</div>
            <div class="pill" id="scoreLabel">Wynik: 0/0</div>
          </div>
          <div class="progress"><div id="progressBar"></div></div>

          <div class="qwrap">
            <div class="qhead">
              <div class="qtitle" id="questionText">Ładowanie pytania…</div>
              <div class="qindex" id="qIndex">#1</div>
            </div>
            <div class="answers" id="answers"></div>
            <div class="explain" id="explainBox"></div>

            <div class="controls">
              <button class="control primary" id="nextBtn">Następne pytanie</button>
              <button class="control" id="restartBtn">Rozpocznij od nowa</button>
            </div>

            <div class="scorebar" id="scoreBar">
              <div>Poprawne: <span class="badge ok" id="okCount">0</span></div>
              <div>Błędne: <span class="badge ko" id="koCount">0</span></div>
            </div>
          </div>
        </div>

        <!-- Summary -->
        <div id="summary" class="hidden">
          <h2>Podsumowanie</h2>
          <p>Twój wynik: <strong id="finalScore">0/0</strong> (<strong id="finalPercent">0%</strong>)</p>
          <p>Ocena: <strong id="gradeText">—</strong></p>
          <div class="controls">
            <button class="control primary" id="restartBtn2">Rozpocznij od nowa</button>
          </div>
        </div>
      </div>

      <footer style="padding:12px 18px;color:#9aa4b2;border-top:1px solid var(--border);font-size:12px;background:rgba(255,255,255,.02)">
        Działa offline • Losowe pytania i odpowiedzi • Wersja HUBERCIK
      </footer>
    </div>
  </div>

<script>
// === Utils ===
function shuffle(arr){
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
  return arr;
}
function grade(percent){
  if(percent>=90) return "Bardzo dobrze";
  if(percent>=75) return "Dobrze";
  if(percent>=60) return "Dostatecznie";
  return "Niezaliczone";
}

// === Questions (50) ===
const QUESTIONS = [
  // Podstawowe i egzaminacyjne (30)
  {q:"Który dokument określa międzynarodowy przewóz drogowy towarów niebezpiecznych?", a:["RID","ADR","ADN","IMDG"], c:1, e:"ADR – Umowa Europejska dotycząca przewozu drogowego towarów niebezpiecznych."},
  {q:"Która klasa ADR obejmuje materiały wybuchowe?", a:["Klasa 3","Klasa 1","Klasa 5.1","Klasa 4.1"], c:1, e:"Klasa 1 – materiały i przedmioty wybuchowe."},
  {q:"Jak oznacza się substancję chemiczną w transporcie drogowym?", a:["Numerem RID","Numerem CAS","Numerem UN","Numerem CLP"], c:2, e:"Numer UN to międzynarodowy kod identyfikacyjny substancji wg ONZ."},
  {q:"Co oznacza litera „X” przed numerem Kemlera?", a:["Substancja palna","Substancja żrąca","Substancja reaguje z wodą","Substancja samozapalna"], c:2, e:"„X” – materiał reaguje niebezpiecznie z wodą (nie używać wody)."},
  {q:"Ile grup pakowania przewiduje ADR?", a:["2","3","4","5"], c:1, e:"Trzy grupy: I (duże), II (średnie), III (małe zagrożenie)."},
  {q:"Która z poniższych klas dotyczy materiałów żrących?", a:["8","7","6","9"], c:0, e:"Klasa 8 – materiały żrące."},
  {q:"Jakiego koloru są tablice ADR umieszczone na pojeździe?", a:["Żółte","Czerwone","Pomarańczowe","Białe"], c:2, e:"Pomarańczowe z czarną obwódką."},
  {q:"Co oznacza numer rozpoznawczy zagrożenia 33?", a:["Gaz duszący","Materiał wybuchowy","Ciecz łatwopalna","Materiał utleniający"], c:2, e:"„3” – palność. „33” – bardzo łatwopalna ciecz."},
  {q:"Która klasa obejmuje materiały promieniotwórcze?", a:["6","7","8","9"], c:1, e:"Klasa 7 – materiały promieniotwórcze."},
  {q:"Który symbol GHS oznacza substancję toksyczną (ostrą)?", a:["GHS05","GHS02","GHS06","GHS08"], c:2, e:"GHS06 – trupia czaszka."},
  {q:"Co zawiera dokument przewozowy ADR w kontekście ładunku?", a:["Tylko dane kierowcy","UN, nazwa, klasa, grupa, nalepki","Tylko nazwę substancji","Jedynie dane nadawcy"], c:1, e:"Dokładne dane identyfikacyjne ładunku niebezpiecznego."},
  {q:"Klasa 5.1 obejmuje:", a:["Materiały zakaźne","Materiały utleniające","Materiały wybuchowe","Gazy"], c:1, e:"5.1 – materiały utleniające (podtrzymują palenie)."},
  {q:"Jakie kolory oznaczają rurociągi gazowe wg PN-70N?", a:["Zielony","Żółty","Fioletowy","Brązowy"], c:1, e:"Żółty – rurociągi z gazem."},
  {q:"Klasa 2.3 dotyczy:", a:["Gazów trujących","Cieczy zapalnych","Gazów sprężonych","Substancji radioaktywnych"], c:0, e:"2.3 – gazy trujące."},
  {q:"Co oznacza symbol GHS03?", a:["Łatwopalny","Utleniający","Toksyczny","Rakotwórczy"], c:1, e:"GHS03 – płomień na kole (utleniający)."},
  {q:"Jakie oznaczenie ma klasa materiałów zakaźnych?", a:["6.1","6.2","7","9"], c:1, e:"6.2 – materiały zakaźne."},
  {q:"Kto wydaje świadectwo ADR dla kierowcy po zdanym egzaminie?", a:["Policja","PSP","Uprawniona jednostka szkoleniowa","PIP"], c:2, e:"Świadectwa wydawane są po kursie ADR i egzaminie."},
  {q:"Co oznacza numer 80 w górnej części tablicy ADR?", a:["Gaz duszący","Substancja żrąca","Utleniająca","Samozapalna"], c:1, e:"„8” – żrące, „0” – brak dodatkowego zagrożenia."},
  {q:"Klasa 4.3 obejmuje:", a:["Wytwarzające gazy zapalne w kontakcie z wodą","Samozapalne","Żrące","Promieniotwórcze"], c:0, e:"4.3 – reagujące z wodą z wydzieleniem gazów zapalnych."},
  {q:"Co określa numer CAS?", a:["Producenta","Substancję chemiczną","Kraj pochodzenia","Grupę pakowania"], c:1, e:"CAS to unikalny numer substancji w bazie Chemical Abstracts Service."},
  {q:"Co oznacza kolor czerwony na butli gazowej (znakowanie pomocnicze)?", a:["Gaz obojętny","Gaz palny","Gaz utleniający","Gaz toksyczny"], c:1, e:"Czerwony – gazy palne."},
  {q:"Co oznacza symbol GHS09?", a:["Toksyczny","Dla środowiska","Żrący","Utleniający"], c:1, e:"GHS09 – niebezpieczny dla środowiska wodnego."},
  {q:"Co określa RID?", a:["Transport drogowy","Transport morski","Transport kolejowy","Transport lotniczy"], c:2, e:"RID – przewóz towarów niebezpiecznych koleją."},
  {q:"Która z klas dotyczy nadtlenków organicznych?", a:["5.2","4.2","2.1","6.1"], c:0, e:"Klasa 5.2 – nadtlenki organiczne."},
  {q:"Co oznacza symbol GHS05?", a:["Żrący","Łatwopalny","Duszący","Promieniotwórczy"], c:0, e:"GHS05 – działanie żrące na skórę / metale."},
  {q:"Które oznaczenie wskazuje na materiał samoreaktywny/samozapalny?", a:["SR","F","T","P"], c:0, e:"SR – samoreaktywne/samozapalne."},
  {q:"Co oznacza ładunek oznaczony „LQ” w ADR?", a:["Limited Quantity","Low Quality","Light Quantity","Large Quantity"], c:0, e:"LQ – ilości ograniczone (zwykle do 30 kg brutto opak. kombinowanego)."},
  {q:"Co oznacza numer 50 w kodzie Kemlera?", a:["Toksyczność","Materiał utleniający","Gaz palny","Substancja żrąca"], c:1, e:"„5” – działanie utleniające."},
  {q:"Co oznacza GHS08?", a:["Drażniący","Rakotwórczy / toksyczny przewlekle","Utleniający","Palny"], c:1, e:"GHS08 – zagrożenia przewlekłe (CMR/STOT)."},
  {q:"Co oznacza kod 90 na tablicy ADR?", a:["Radioaktywny","Zakaźny","Niebezpieczny dla środowiska","Utleniający"], c:2, e:"„9” – różne zagrożenia, m.in. środowiskowe."},
  // Dodatkowe (20)
  {q:"Wysokość montażu pomarańczowych tablic na pojeździe powinna wynosić:", a:["0,2–1,0 m","0,5–2,0 m","1,0–2,5 m","Dowolna"], c:1, e:"ADR wymaga 0,5–2,0 m nad jezdnią."},
  {q:"Minimalny bok nalepki ostrzegawczej ADR na sztuce przesyłki to:", a:["50 mm","100 mm","150 mm","250 mm"], c:1, e:"Standardowo 100 mm (klasa 7 na pojeździe – 250 mm)."},
  {q:"Nalepka klasy 7 (promieniotwórcze) na pojeździe powinna mieć długość boku:", a:["100 mm","150 mm","200 mm","250 mm"], c:3, e:"Dla klasy 7 na pojeździe stosuje się większy rozmiar – 250 mm."},
  {q:"Tablice pomarańczowe bez numerów stosuje się, gdy:", a:["Przewozi się luzem jeden materiał","Przewozi się mieszany asortyment w opakowaniach","Przewóz dotyczy tylko klasy 9","Gdy brak dokumentów"], c:1, e:"Mieszany asortyment jako sztuki przesyłki – tablice bez numerów."},
  {q:"Które klasy materiałów nie mają przypisanych grup pakowania?", a:["1, 2, 5.2, 6.2, 7","3, 4, 5.1","6.1, 8, 9","Wszystkie mają"], c:0, e:"Grupy pakowania nie dotyczą m.in. klas 1, 2, 5.2, 6.2, 7."},
  {q:"Gdzie w przepisach ADR znajdziesz grupę pakowania dla danej pozycji UN?", a:["Dział 1.7","Tabela A, dział 3.2, kol. 4","Załącznik B","Instrukcje pisemne"], c:1, e:"Tabela A (3.2) kolumna 4 – grupa pakowania."},
  {q:"Akumulatory litowo-jonowe klasyfikuje się w ADR jako:", a:["Klasa 3","Klasa 6.1","Klasa 9","Klasa 5.1"], c:2, e:"Akumulatory litowe to klasa 9 (różne materiały niebezpieczne)."},
  {q:"Co oznacza powtórzenie cyfry w numerze Kemlera (np. 33, 55)?", a:["Brak dodatkowego zagrożenia","Podwyższone natężenie zagrożenia","Oznaczenie substancji radioaktywnej","Zagrożenie dla środowiska"], c:1, e:"Podwojenie cyfry wskazuje silniejsze zagrożenie dominujące."},
  {q:"Litera „W” w kodzie klasyfikacyjnym oznacza materiał:", a:["Utleniający","Reagujący z wodą","Samozapalny","Promieniotwórczy"], c:1, e:"„W” – reagujący z wodą (water-reactive)."},
  {q:"Co kierowca powinien zrobić w pierwszej kolejności przy zdarzeniu ADR?", a:["Podać sorbent","Zatrzymać pojazd i wyłączyć silnik","Rozwinąć linię gaśniczą","Uspokoić świadków"], c:1, e:"Instrukcja pisemna: zatrzymać pojazd i wyłączyć silnik/instalację."},
  {q:"W ADR „LQ > 8 ton” odnosi się do:", a:["Zakazu przewozu","Wymogu oznakowania pojazdu LQ","Obowiązku eskorty","Zwolenienia z tablic"], c:1, e:"Pojazdy z LQ > 8 t brutto muszą być oznakowane odpowiednim znakiem."},
  {q:"Minimalny rozmiar znaku dla „Excepted Quantities (EQ)” to:", a:["50×50 mm","80×80 mm","100×100 mm","120×120 mm"], c:2, e:"Wymagany jest znak co najmniej 100×100 mm."},
  {q:"Kolor rurociągów dla kwasów i zasad wg PN-70N to:", a:["Zielony","Żółty","Fioletowy","Brązowy"], c:2, e:"Fioletowy – kwasy i zasady."},
  {q:"Symbol GHS04 oznacza:", a:["Gaz pod ciśnieniem","Materiał wybuchowy","Substancję żrącą","Toksyczność ostrą"], c:0, e:"GHS04 – butla gazowa, gazy pod ciśnieniem."},
  {q:"Znak „podwyższona temperatura” dla cieczy stosuje się, gdy temperatura wynosi:", a:["≥ 61°C","≥ 80°C","≥ 100°C","≥ 240°C"], c:2, e:"Dla cieczy znak stosuje się przy ≥100°C (np. UN 3257)."},
  {q:"Numer rozpoznawczy zagrożenia umieszczony jest:", a:["Na dolnej połowie tablicy","Na górnej połowie tablicy","Na bocznej nalepce","Wyłącznie w dokumentach"], c:1, e:"Górny numer (Kemlera) – rodzaj zagrożenia; dolny – numer UN."},
  {q:"Która klasa dotyczy cieczy zapalnych?", a:["Klasa 2","Klasa 3","Klasa 4.3","Klasa 8"], c:1, e:"Klasa 3 – materiały ciekłe zapalne."},
  {q:"Jak oznacza się pojazd przewożący mieszany asortyment ADR jako sztuki przesyłki?", a:["Tablice z numerami UN i Kemlera","Tablice bez numerów","Brak tablic","Tylko nalepki boczne"], c:1, e:"Mieszany asortyment w opakowaniach – tablice bez numerów."},
  {q:"Co opisuje numer UN?", a:["Czterocyfrowy numer przypisany substancji/mieszaninie","Kod producenta","Numer partii","Wyłącznie odpady"], c:0, e:"UN to czterocyfrowy numer identyfikacyjny substancji wg ONZ."}
];

// Ensure we have 50 questions (in case of edits)
const TOTAL = 50;
if(QUESTIONS.length !== TOTAL){
  console.warn("Liczba pytań wynosi", QUESTIONS.length, "– oczekiwano 50.");
}

// === State ===
let order = [];
let current = 0;
let ok=0, bad=0, answered=false;
let mappedAnswers = []; // current answer order with index of correct

// === Elements ===
const startScreen = document.getElementById('startScreen');
const startBtn = document.getElementById('startBtn');
const quizUI = document.getElementById('quizUI');
const progressLabel = document.getElementById('progressLabel');
const scoreLabel = document.getElementById('scoreLabel');
const progressBar = document.getElementById('progressBar');
const questionText = document.getElementById('questionText');
const qIndex = document.getElementById('qIndex');
const answersBox = document.getElementById('answers');
const explainBox = document.getElementById('explainBox');
const nextBtn = document.getElementById('nextBtn');
const restartBtn = document.getElementById('restartBtn');
const scoreBar = document.getElementById('scoreBar');
const okCount = document.getElementById('okCount');
const koCount = document.getElementById('koCount');
const summary = document.getElementById('summary');
const finalScore = document.getElementById('finalScore');
const finalPercent = document.getElementById('finalPercent');
const gradeText = document.getElementById('gradeText');
const restartBtn2 = document.getElementById('restartBtn2');

function init(){
  // Shuffle order of questions
  order = Array.from(QUESTIONS.keys());
  shuffle(order);
  current = 0; ok=0; bad=0; answered=false;
  quizUI.classList.remove('hidden');
  startScreen.classList.add('hidden');
  summary.classList.add('hidden');
  scoreBar.classList.remove('hidden');
  updateScoreBar();
  loadQuestion();
}
function updateScoreBar(){
  scoreLabel.textContent = `Wynik: ${ok}/${ok+bad}`;
  okCount.textContent = ok;
  koCount.textContent = bad;
}
function loadQuestion(){
  if(current >= TOTAL){
    // Summary
    quizUI.classList.add('hidden');
    summary.classList.remove('hidden');
    const percent = Math.round((ok / TOTAL) * 100);
    finalScore.textContent = `${ok}/${TOTAL}`;
    finalPercent.textContent = `${percent}%`;
    gradeText.textContent = grade(percent);
    return;
  }
  const qi = order[current];
  const item = QUESTIONS[qi];
  questionText.textContent = item.q;
  qIndex.textContent = `#${current+1}`;
  progressLabel.textContent = `Pytanie ${current+1}/${TOTAL}`;
  progressBar.style.width = `${((current)/TOTAL)*100}%`;

  // Build answers with random order
  answersBox.innerHTML = "";
  explainBox.style.display = "none";
  mappedAnswers = item.a.map((text, idx)=>({text, idx}));
  shuffle(mappedAnswers);
  mappedAnswers.forEach((ans, i)=>{
    const btn = document.createElement('button');
    btn.className = 'btn';
    btn.innerHTML = `<div class="letter">${String.fromCharCode(65+i)}</div><div class="ans-text">${ans.text}</div>`;
    btn.addEventListener('click', ()=>pickAnswer(i, item));
    answersBox.appendChild(btn);
  });
  answered = false;
}
function pickAnswer(i, item){
  if(answered) return;
  answered = true;
  // Determine which index is correct after shuffle
  const correctIndex = mappedAnswers.findIndex(a=>a.idx === item.c);
  const btns = Array.from(answersBox.children);
  btns.forEach((b, idx)=>{
    if(idx === correctIndex) b.classList.add('correct');
    if(idx === i && i !== correctIndex) b.classList.add('wrong');
  });
  if(i === correctIndex){ ok++; } else { bad++; }
  updateScoreBar();
  explainBox.textContent = item.e;
  explainBox.style.display = "block";
  // Move progress ahead slightly to show current question progress
  progressBar.style.width = `${((current+1)/TOTAL)*100}%`;
}
nextBtn.addEventListener('click', ()=>{
  if(!answered) return; // force answering
  current++;
  loadQuestion();
});
restartBtn.addEventListener('click', ()=>{
  init();
});
restartBtn2 && restartBtn2.addEventListener('click', ()=>{
  init();
});
startBtn.addEventListener('click', ()=>{
  init();
});
</script>
</body>
</html>
